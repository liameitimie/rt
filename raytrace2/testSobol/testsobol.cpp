#include <cuda_runtime.h>
#include <iostream>
#include <stdlib.h>
#include <opencv2/opencv.hpp>
#define uint unsigned int

using namespace std;

uint v[40*32]={
2147483648, 1073741824, 536870912, 268435456, 134217728, 67108864, 33554432, 16777216, 8388608, 4194304, 2097152, 1048576, 524288, 262144, 131072, 65536, 32768, 16384, 8192, 4096, 2048, 1024, 512, 256, 128, 64, 32, 16, 8, 4, 2, 1,
2147483648, 3221225472, 2684354560, 4026531840, 2281701376, 3422552064, 2852126720, 4278190080, 2155872256, 3233808384, 2694840320, 4042260480, 2290614272, 3435921408, 2863267840, 4294901760, 2147516416, 3221274624, 2684395520, 4026593280, 2281736192, 3422604288, 2852170240, 4278255360, 2155905152, 3233857728, 2694881440, 4042322160, 2290649224, 3435973836, 2863311530, 4294967295,
2147483648, 3221225472, 1610612736, 2415919104, 3892314112, 1543503872, 2382364672, 3305111552, 1753219072, 2629828608, 3999268864, 1435500544, 2154299392, 3231449088, 1626210304, 2421489664, 3900735488, 1556135936, 2388680704, 3314585600, 1751705600, 2627492864, 4008611328, 1431684352, 2147543168, 3221249216, 1610649184, 2415969680, 3892340840, 1543543964, 2382425838, 3305133397,
2147483648, 3221225472, 536870912, 1342177280, 4160749568, 1946157056, 2717908992, 2466250752, 3632267264, 624951296, 1507852288, 3872391168, 2013790208, 3020685312, 2181169152, 3271884800, 546275328, 1363623936, 4226424832, 1977167872, 2693105664, 2437829632, 3689389568, 635137280, 1484783744, 3846176960, 2044723232, 3067084880, 2148008184, 3222012020, 537002146, 1342505107,
2147483648, 1073741824, 536870912, 2952790016, 4160749568, 3690987520, 2046820352, 2634022912, 1518338048, 801112064, 2707423232, 4038066176, 3666345984, 1875116032, 2170683392, 1085997056, 579305472, 3016343552, 4217741312, 3719483392, 2013407232, 2617981952, 1510979072, 755882752, 2726789248, 4090085440, 3680870432, 1840435376, 2147625208, 1074478300, 537900666, 2953698205,
2147483648, 1073741824, 1610612736, 805306368, 3355443200, 603979776, 1442840576, 4211081216, 3766484992, 1883242496, 2824863744, 338690048, 2663907328, 3743678464, 3067478016, 2344288256, 1207992320, 1677737984, 905994240, 3405787136, 679528448, 1413489664, 4267726336, 4012964608, 2118705280, 2942595136, 515287136, 2676692016, 3603439304, 3139739428, 2161563350, 1086045115,
2147483648, 3221225472, 2684354560, 3489660928, 1476395008, 2483027968, 1040187392, 3808428032, 3196059648, 599785472, 505413632, 4077912064, 1182269440, 1736704000, 2017853440, 2221342720, 3329785856, 2810494976, 3628507136, 1416089600, 2658719744, 864310272, 3863387648, 3076993792, 553150080, 272922560, 4167467040, 1148698640, 1719673080, 2009075780, 2149644390, 3222291575,
2147483648, 1073741824, 2684354560, 1342177280, 2281701376, 603979776, 301989888, 754974720, 1988100096, 2654994432, 136314880, 1678770176, 2988965888, 2098462720, 4272029696, 3125346304, 438599680, 1226522624, 3300237312, 3816001536, 4135585792, 3728737280, 2820672000, 873465088, 975702144, 1494483520, 3970040096, 2538144464, 1822721896, 3613084132, 3432358018, 2271450689,
2147483648, 1073741824, 2684354560, 1342177280, 671088640, 3556769792, 1778384896, 1895825408, 947912704, 1480589312, 3927965696, 823132160, 2561146880, 139722752, 3257532416, 3844407296, 4071784448, 2034778112, 4205060096, 3178434560, 413665280, 1213465600, 1646922240, 3039102208, 3669131904, 2907196736, 2426676896, 3430094608, 539495304, 269746564, 2282357922, 2218067473,
2147483648, 1073741824, 3758096384, 2952790016, 2550136832, 2483027968, 2315255808, 1526726656, 864026624, 3653238784, 1914699776, 1058013184, 3250061312, 2800484352, 1401290752, 703922176, 171606016, 455786496, 3549618176, 1778348032, 3929540608, 2871788544, 1269173760, 4259646208, 1610779008, 4026976576, 2016733344, 605713840, 305826616, 3475687836, 3113412898, 2197780721,
2147483648, 1073741824, 2684354560, 268435456, 134217728, 1811939328, 2650800128, 587202560, 1468006400, 2915041280, 2141192192, 2446327808, 1233649664, 3470000128, 2282356736, 739180544, 1041072128, 857194496, 1605394432, 3254300672, 3784148992, 3000484864, 504392192, 1663611136, 4152723584, 3183723200, 2008703968, 4260868912, 3615493624, 3988785180, 3751805978, 2177894957,
2147483648, 1073741824, 536870912, 805306368, 1476395008, 2885681152, 2516582400, 721420288, 3565158400, 155189248, 3802136576, 1380974592, 1311244288, 3340500992, 1654521856, 308740096, 1846771712, 4147232768, 983080960, 3192164352, 4164651008, 3693986816, 3993412096, 3072561920, 447221120, 2388397760, 2688420704, 1882653104, 2017167560, 2620246612, 3456542538, 2267256725,
2147483648, 3221225472, 2684354560, 1342177280, 4160749568, 2348810240, 3791650816, 855638016, 260046848, 557842432, 2510290944, 1584398336, 3624402944, 472121344, 3122003968, 4013359104, 361136128, 2658123776, 2015059968, 1278513152, 1108248576, 1661717504, 4155337216, 2910033152, 2004879232, 1832912064, 3617588256, 1030751792, 797446008, 2976123604, 3451258746, 2185692887,
2147483648, 3221225472, 1610612736, 2415919104, 939524096, 3288334336, 1107296256, 2734686208, 4051697664, 2856321024, 4242538496, 2232418304, 3758620672, 1342963712, 1476788224, 1409875968, 2047049728, 1728856064, 3011780608, 155856896, 225384448, 794469376, 484953600, 3574878464, 3087007872, 67109056, 570425440, 855638160, 3380609080, 1849688260, 3202351170, 638582947,
2147483648, 1073741824, 536870912, 4026531840, 2818572288, 1409286144, 2583691264, 2634022912, 511705088, 1556086784, 2099249152, 2366636032, 612892672, 1908670464, 3953262592, 1977548800, 1805811712, 902905856, 1269014528, 3318927360, 3819005952, 2447084544, 2041508352, 215957760, 1730838656, 1343569984, 436314144, 3708670192, 1048832168, 2898971732, 3576517274, 3642593693,
2147483648, 3221225472, 536870912, 3489660928, 3623878656, 3288334336, 1174405120, 2231369728, 2776629248, 1992294400, 2912944128, 1789919232, 765984768, 2864447488, 229244928, 2058420224, 3584524288, 3200073728, 2476990464, 1001721856, 908703744, 1299348480, 2609078784, 667211520, 3056187520, 2373090496, 3145949728, 4156872656, 1848227928, 1232239620, 4253246054, 1925502805,
2147483648, 1073741824, 536870912, 4026531840, 939524096, 335544320, 4127195136, 1728053248, 2407530496, 1346371584, 2325741568, 267386880, 312999936, 2884894720, 4238999552, 687538176, 3173613568, 196755456, 1309073408, 856436736, 1501960192, 3343725568, 1026339328, 1270008576, 1845893248, 3272422464, 1636610592, 3544370160, 3408795832, 750335060, 3783701206, 2471086999,
2147483648, 3221225472, 536870912, 4026531840, 1744830464, 1677721600, 905969664, 1828716544, 1098907648, 3762290688, 3537895424, 2616197120, 216530944, 1392246784, 1533673472, 800260096, 2685173760, 805650432, 1208475648, 2484047872, 1577187328, 151950336, 2005554688, 2369874688, 2473195648, 2075301056, 3724564000, 3372379120, 1468889320, 2102121636, 4218271254, 532609949,
2147483648, 1073741824, 2684354560, 1342177280, 2550136832, 4093640704, 2919235584, 3137339392, 3883925504, 2512388096, 471859200, 3492806656, 3685220352, 1442054144, 4286709760, 566296576, 304316416, 993673216, 2754306048, 875622400, 1302763520, 1257499648, 772028928, 4211744512, 1199904896, 3318328384, 2217695904, 607842128, 1973649432, 4009377972, 403398670, 3019960555,
2147483648, 3221225472, 3758096384, 2952790016, 3087007744, 1006632960, 3456106496, 1090519040, 562036736, 1371537408, 157286400, 2238709760, 4067950592, 2392588288, 1610743808, 1879244800, 1476624384, 2348990464, 1979899904, 2097213440, 4018354176, 281084928, 685803008, 3568387840, 4212663680, 200152512, 2457455072, 4271716976, 939524104, 4227858444, 771751950, 4043309067,
2147483648, 3221225472, 3758096384, 3489660928, 1744830464, 1006632960, 2315255808, 1358954496, 2843738112, 3720347648, 1537212416, 969932800, 2516058112, 1456734208, 167903232, 2432892928, 1233354752, 230899712, 866230272, 97579008, 536487936, 131417088, 2743117312, 1287681792, 304279168, 873703232, 2791045088, 1392880464, 368574472, 2530476044, 3925999630, 1090715661,
2147483648, 1073741824, 1610612736, 3489660928, 939524096, 2348810240, 2113929216, 1895825408, 3363831808, 79691776, 463470592, 3144679424, 1251475456, 3283877888, 2785148928, 1828782080, 4001464320, 700661760, 2501959680, 1118973952, 3887724544, 219005952, 1069097472, 286069504, 431746688, 1007463872, 2537179744, 3318710000, 974651400, 192675844, 2745303046, 2003894285,
2147483648, 3221225472, 2684354560, 2415919104, 134217728, 1677721600, 1778384896, 2298478592, 2776629248, 3409969152, 404750336, 2911895552, 2944925696, 1928593408, 629276672, 188940288, 3089268736, 1032994816, 2810716160, 385191936, 1334028288, 2185307136, 497030656, 4140920064, 3215474816, 3144099392, 3758691872, 4038389712, 941785096, 4254220300, 126361610, 2264240137,
2147483648, 3221225472, 536870912, 3489660928, 1207959552, 2348810240, 3590324224, 956301312, 3581935616, 843055104, 2996830208, 1913651200, 1406664704, 2194407424, 3414294528, 1195573248, 2434826240, 2840805376, 2096701440, 1318989824, 4244199424, 2392843264, 3707360768, 1587316992, 2499373696, 3533682752, 1123661664, 3952910128, 2541256712, 3655286796, 635117570, 2882351117,
2147483648, 3221225472, 536870912, 1342177280, 3623878656, 4093640704, 1040187392, 2499805184, 2407530496, 1027604480, 4078960640, 787480576, 2915565568, 168558592, 2334261248, 1257439232, 1808302080, 990724096, 3802226688, 380686336, 694712320, 3183416320, 868965888, 252454144, 4238455936, 3551571904, 2129357088, 1962822960, 4276647944, 3036615692, 3739966978, 3841729797,
2147483648, 1073741824, 2684354560, 2952790016, 2550136832, 2751463424, 2046820352, 3573547008, 41943040, 1614807040, 1373634560, 2289041408, 2351431680, 1204027392, 199360512, 2909863936, 3064627200, 864468992, 3087032320, 1409519616, 1107519488, 3238106112, 3766643200, 289607936, 694202240, 1026651584, 3746183840, 2952044048, 3593168904, 1657115652, 828402186, 3643937035,
2147483648, 3221225472, 2684354560, 805306368, 402653184, 872415232, 2315255808, 2634022912, 1736441856, 2185232384, 1088421888, 1626341376, 2437414912, 692322304, 761397248, 3216179200, 371884032, 4227121152, 3838468096, 3255291904, 537044992, 4026643456, 3087236608, 67246336, 2449689472, 2835556288, 3984716576, 524343312, 660613128, 3803280396, 3517652490, 1236715779,
2147483648, 1073741824, 3758096384, 3489660928, 134217728, 1275068416, 33554432, 3036676096, 914358272, 3267362816, 337641472, 122683392, 469237760, 1345585152, 1218576384, 2895183872, 3545989120, 3165077504, 2079989760, 3224645632, 2694940672, 814781440, 3646650880, 1168472832, 1333426304, 3086416192, 2181119456, 4110606288, 3598845960, 314823684, 472078862, 1263553293,
2147483648, 3221225472, 3758096384, 1342177280, 1744830464, 1275068416, 1979711488, 4143972352, 914358272, 3611295744, 2279604224, 4012900352, 2745696256, 3578003456, 598343680, 356974592, 3282665472, 1162231808, 2879922176, 155676672, 3718903808, 4265913344, 3945341440, 688386304, 1825258880, 3325316544, 3479286560, 326310096, 3972742536, 104091084, 794932014, 1131616469,
2147483648, 1073741824, 1610612736, 2415919104, 3355443200, 1946157056, 1375731712, 50331648, 3951034368, 1866465280, 1684013056, 3673161728, 395837440, 695992320, 2778333184, 4202496000, 3860561920, 1899970560, 410558464, 3704524800, 3059869696, 2582813696, 2618836480, 3594395904, 167401344, 1418595008, 2743118304, 1531002672, 1449285512, 1240599236, 874162662, 842809145,
2147483648, 3221225472, 2684354560, 3489660928, 3087007744, 67108864, 1845493760, 2533359616, 4068474880, 3988783104, 325058560, 1552941056, 3679977472, 837025792, 165281792, 3425107968, 45645824, 1152663552, 266493952, 3864023040, 2595870720, 1354042368, 2044891648, 2773678848, 3191390080, 779606336, 4127197920, 2197885648, 2222997384, 2932054348, 937585386, 575750877,
2147483648, 3221225472, 3758096384, 805306368, 1744830464, 3959422976, 570425344, 721420288, 914358272, 2638217216, 1780482048, 376438784, 1307049984, 856424448, 2473197568, 2186215424, 994672640, 2403319808, 673193984, 3446697984, 4083853312, 1917836288, 3008098816, 1396599040, 1646295680, 175194304, 3890898208, 3289223408, 4025088648, 3624829132, 1172981038, 789438707,
2147483648, 3221225472, 536870912, 805306368, 671088640, 3556769792, 2315255808, 4278190080, 2222981120, 1941962752, 320864256, 3266314240, 4214751232, 907804672, 1075445760, 3769565184, 287473664, 431210496, 4256702464, 1591709696, 1975027712, 2061478912, 4156209664, 1641935616, 3510140544, 958289344, 3432753248, 2003615408, 2684417672, 4026661324, 134287970, 3825290675,
2147483648, 1073741824, 2684354560, 1342177280, 3087007744, 2214592512, 436207616, 2936012800, 3179282432, 3753902080, 350224384, 1129316352, 3661103104, 1310457856, 1289355264, 911015936, 694190080, 3700441088, 1859674112, 1565478912, 786466816, 4233210880, 2142772736, 1172079360, 4198122880, 1578984000, 1423692640, 3796814128, 2338508168, 4153462340, 3378105706, 764365365,
2147483648, 1073741824, 3758096384, 1879048192, 134217728, 4093640704, 4127195136, 2332033024, 3380609024, 1430257664, 1730150400, 4092592128, 880279552, 1464074240, 450494464, 2985623552, 2843836416, 1698742272, 2401476608, 2012352512, 3397122048, 675675136, 626720256, 1874229504, 119749248, 3287440064, 3699043680, 3544482512, 3839443592, 3472320196, 2516824942, 3137399767,
2147483648, 1073741824, 3758096384, 2415919104, 1744830464, 4093640704, 1644167168, 3741319168, 2038431744, 3711959040, 1994391552, 753926144, 3484942336, 1374420992, 3369730048, 2220687360, 2608955392, 1111703552, 4016185344, 1639026688, 3512215552, 2300357632, 1700949504, 179374336, 719043968, 459114176, 33637728, 251864176, 4051834248, 3108137668, 2095123310, 133414265,
2147483648, 3221225472, 1610612736, 1342177280, 402653184, 3690987520, 1107296256, 922746880, 545259520, 4047503360, 677380096, 2492465152, 2273837056, 2822504448, 1433010176, 3874422784, 4160978944, 1275215872, 973201408, 3137482752, 2055301120, 440642560, 1256294912, 1389566208, 2405966720, 3454900032, 4202741664, 3661886128, 719506312, 47217484, 2540361126, 300800949,
2147483648, 3221225472, 536870912, 4026531840, 4160749568, 872415232, 1644167168, 4110417920, 2826960896, 4240441344, 2384461824, 1408237568, 3346530304, 2507407360, 3087138816, 3571777536, 2994765824, 4257267712, 1688215552, 2855333888, 433649664, 239350784, 2472174080, 3881956608, 1702504576, 1083260096, 3758239264, 3504694256, 142647160, 3435172212, 1444938242, 2549147109,
2147483648, 3221225472, 2684354560, 4026531840, 4160749568, 3959422976, 2113929216, 1627389952, 1551892480, 3871342592, 3718250496, 711983104, 2469920768, 332136448, 3553492992, 1937309696, 2208333824, 2070986752, 2545459200, 3909939200, 2288973824, 3557420032, 840498688, 4017922304, 3310812288, 1455756992, 1163306400, 2529494640, 3847671096, 1724203724, 492197710, 2328185273,
2147483648, 3221225472, 536870912, 2952790016, 1476395008, 738197504, 2583691264, 4177526784, 1015021568, 2998927360, 2904555520, 976224256, 2308440064, 1150025728, 787087360, 1870725120, 4011884544, 791724032, 253239296, 3209474048, 3880409088, 3413191680, 1368922624, 2827761920, 2498370688, 645989056, 2342548768, 2985350704, 943207320, 2088504716, 1381124714, 1027469633
};


float sobol(uint d,uint i){
	i^=(i>>1); //×ªÎª¸ñÀ×Âë 
	uint res=0,offset=d*32;
	for(uint j=0;i;i>>=1,j++){
		if(i&1) res^=v[j+offset];
	}
	return res*(1.0f/(float)0xFFFFFFFF);
}

int t;
float3 c[800*800];

double rand_double(){
	return (double)rand()/RAND_MAX;
}

int main(){
	for(int i=0;i<=1000;i++){
		float x=sobol(1,i);
		float y=sobol(2,i);
//		float x=rand_double(),y=rand_double();
		int ix=x*800,iy=y*800;
		int idx=(800-iy-1)*800+ix;
		c[idx]={255.0f,255.0f,255.0f};
		cv::Mat image(800,800,CV_32FC3,&c[0]);
		image.convertTo(image, CV_8UC3,1.0f);
		cv::cvtColor(image, image, cv::COLOR_RGB2BGR);
		cv::imshow("image",image);
		//cout<<x<<' '<<y<<' '<<idx<<endl;
		cv::waitKey(1);
		if(i==1000) cv::imwrite("image1.png",image);
	}
	return 0;
}
//nvcc -I C:\opencv\build\include -I C:\opencv\build\include\opencv2 -L C:\opencv\build\x64\vc15\lib -l opencv_world454 -o testsobol.exe testsobol.cpp
